Traceback (most recent call last):
  File "main.py", line 13, in <module>
    from rouge_score import rouge_scorer
  File "/data/qin/anaconda3/envs/promptsumm/lib/python3.7/site-packages/rouge_score/rouge_scorer.py", line 41, in <module>
    from nltk.stem import porter
  File "/data/qin/anaconda3/envs/promptsumm/lib/python3.7/site-packages/nltk/__init__.py", line 128, in <module>
    from nltk.collocations import *
  File "/data/qin/anaconda3/envs/promptsumm/lib/python3.7/site-packages/nltk/collocations.py", line 39, in <module>
    from nltk.metrics import (
  File "/data/qin/anaconda3/envs/promptsumm/lib/python3.7/site-packages/nltk/metrics/__init__.py", line 16, in <module>
    from nltk.metrics.scores import (
  File "/data/qin/anaconda3/envs/promptsumm/lib/python3.7/site-packages/nltk/metrics/scores.py", line 15, in <module>
    from scipy.stats.stats import betai
  File "/data/qin/anaconda3/envs/promptsumm/lib/python3.7/site-packages/scipy/stats/__init__.py", line 388, in <module>
    from .stats import *
  File "/data/qin/anaconda3/envs/promptsumm/lib/python3.7/site-packages/scipy/stats/stats.py", line 180, in <module>
    from . import distributions
  File "/data/qin/anaconda3/envs/promptsumm/lib/python3.7/site-packages/scipy/stats/distributions.py", line 8, in <module>
  File "/data/qin/anaconda3/envs/promptsumm/lib/python3.7/site-packages/scipy/stats/_distn_infrastructure.py", line 23, in <module>
    from scipy import optimize
  File "/data/qin/anaconda3/envs/promptsumm/lib/python3.7/site-packages/scipy/optimize/__init__.py", line 388, in <module>
    from ._minimize import *
  File "/data/qin/anaconda3/envs/promptsumm/lib/python3.7/site-packages/scipy/optimize/_minimize.py", line 23, in <module>
Traceback (most recent call last):
  File "/data/qin/anaconda3/envs/promptsumm/lib/python3.7/subprocess.py", line 1019, in wait
    return self._wait(timeout=timeout)
  File "/data/qin/anaconda3/envs/promptsumm/lib/python3.7/subprocess.py", line 1653, in _wait
    (pid, sts) = self._try_wait(0)
  File "/data/qin/anaconda3/envs/promptsumm/lib/python3.7/subprocess.py", line 1611, in _try_wait
    (pid, sts) = os.waitpid(self.pid, wait_flags)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data/qin/anaconda3/envs/promptsumm/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/data/qin/anaconda3/envs/promptsumm/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/data/qin/anaconda3/envs/promptsumm/lib/python3.7/site-packages/torch/distributed/launch.py", line 260, in <module>
    main()
  File "/data/qin/anaconda3/envs/promptsumm/lib/python3.7/site-packages/torch/distributed/launch.py", line 253, in main
    process.wait()
  File "/data/qin/anaconda3/envs/promptsumm/lib/python3.7/subprocess.py", line 1032, in wait
    self._wait(timeout=sigint_timeout)
  File "/data/qin/anaconda3/envs/promptsumm/lib/python3.7/subprocess.py", line 1647, in _wait
    time.sleep(delay)
KeyboardInterrupt
    from ._trustregion_dogleg import _minimize_dogleg
  File "<frozen importlib._bootstrap>", line 983, in _find_and_load
  File "<frozen importlib._bootstrap>", line 967, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 677, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 724, in exec_module
  File "<frozen importlib._bootstrap_external>", line 818, in get_code
  File "<frozen importlib._bootstrap_external>", line 917, in get_data
KeyboardInterrupt
05/25/2022 01:09:41 - INFO - root -   Namespace(adam_epsilon=1e-08, batch_size_per_gpu_entity=2, batch_size_per_gpu_pretrain=1, batch_size_per_gpu_summary=1, build_salient_entities=False, cache_path='/data/qin/hf_models/t5-v1-large/', concat_mode='concat_right', counterfactual_removal=False, cuda='3', data_dir='/data/qin/DATASETS/PromptSumm/', dataset='c4', dataset_cache_dir='../../hf_datasets/', dataset_name='c4', dataset_version='en', debug=False, debug_pretrain=False, eval_start_step=30000, eval_step=15000, exp_id='012', few_shot=10, filter_type=None, finetune_entity=False, finetune_summary=True, gradient_accumulation_steps_entity=2, gradient_accumulation_steps_pretrain=8, gradient_accumulation_steps_summary=8, guidance_mode='input', guidance_type='ents', if_spacy=True, infer_val_entities=False, length_penalty=1.0, lm_adapted_path='/data/qin/lm_adapted_t5model/torch_ckpt/large/pytorch_model.bin', local_rank=0, log_dir='./log', log_name='012', log_step_finetune=1, log_step_pretrain=50, lr_entity=0.5, lr_pretrain=0.5, lr_summary=0.5, max_epoch_entity=60, max_epoch_pretrain=5, max_epoch_summary=30, max_grad_norm_entity=1.0, max_grad_norm_pretrain=1.0, max_grad_norm_summary=1.0, max_guidance_length=100, max_length=512, max_summary_length=64, model='T5MixPrompt', model_name='google/t5-v1_1-large', num_beams=4, num_seeds=3, num_workers_entity=4, num_workers_pretrain=4, num_workers_summary=0, pretrain=True, pretrain_all_weights=True, pretrain_ckpt='/data/qin/PromptSumm/Summarization/t5_tagger_pretrained_ckpt/bestckpt_full_model', pretrain_dataset_path='/data/hailin/PromptSumm/c4_realnewslike', pretrain_prompt_ckpt='/data/qin/PromptSumm/Summarization/t5_tagger_pretrained_ckpt/bestckpt_prompt', pretrain_with_ent_chain=False, pretraining_train_size=204045, pretraining_val_size=1000, prompt_number=300, repetition_penalty=2.5, save_model=False, save_model_path='', seed=42, separator=',', stemmer=True, test_size_per_gpu_entity=8, test_size_per_gpu_pretrain=8, test_size_per_gpu_summary=8, train_sample_summary=True, use_huggingface_dataset=True, use_lm_adapted=1, use_pretrain_ckpt=True, use_t5_tagger=True, valid_size_per_gpu_entity=4, valid_size_per_gpu_pretrain=4, valid_size_per_gpu_summary=4, warmup_steps_entity=0.01, warmup_steps_pretrain=0.01, warmup_steps_summary=0.01, weight_decay_entity=1e-05, weight_decay_pretrain=0, weight_decay_summary=1e-05, zero_shot=False)
05/25/2022 01:09:45 - INFO - root -   device cuda
05/25/2022 01:09:52 - INFO - root -   gen token = summerizationcnndm , gen token id = 32100
05/25/2022 01:09:52 - INFO - root -   subsampling..
/data/qin/PromptSumm/Summarization/t5_tagger_pretrained_ckpt/bestckpt_full_model
/data/qin/PromptSumm/Summarization/t5_tagger_pretrained_ckpt/bestckpt_prompt
05/25/2022 01:09:52 - INFO - root -   
**************************************************
05/25/2022 01:09:52 - INFO - root -   1/ Pre-training...
Pre-training entity tagger...
pretrain_all_weights
05/25/2022 01:10:17 - INFO - engine_pretrain -   The model has 783150080 trainable parameters
prompt torch.Size([300, 1024])
05/25/2022 01:10:20 - INFO - engine_pretrain -   Begin pre-train...
05/25/2022 01:10:20 - INFO - root -   Training is not really distributed, single rank. Deactivating buckets
05/25/2022 01:10:20 - INFO - root -   ShardedDDP bucket size: 0.00M parameters, model size 747.46M parameters
05/25/2022 01:10:20 - INFO - engine_pretrain -   0
